from gmpy2 import *
from Crypto.Util.number import bytes_to_long, long_to_bytes,getPrime

flag = b'flag{Q1RGX2lzX2Z1bl8yMDI1IQ==}'  # 保持原始的 base64 编码内容
e = 11  # 修改为新的指数
m = bytes_to_long(flag)

q1,q2, q3, q4, q5, q6, q7, q8, q9, q10, q11, q12, q13, q14, q15, q16, q17, q18, q19, q20 = [getPrime(67) for _ in range(20)]
p1,p2, p3, p4, p5, p6, p7, p8, p9, p10, p11, p12, p13, p14, p15, p16, p17, p18, p19, p20 = [getPrime(78) for _ in range(20)]

n1,n2, n3, n4, n5, n6, n7, n8, n9, n10, n11, n12, n13, n14, n15, n16, n17, n18, n19, n20 = [p*q for p,q in zip([p1,p2,p3,p4,p5,p6,p7,p8,p9,p10,p11,p12,p13,p14,p15,p16,p17,p18,p19,p20],[q1,q2,q3,q4,q5,q6,q7,q8,q9,q10,q11,q12,q13,q14,q15,q16,q17,q18,q19,q20])]

c1,c2, c3, c4, c5, c6, c7, c8, c9, c10, c11, c12, c13, c14, c15, c16, c17, c18, c19, c20 = [pow(m,e,n) for n in [n1,n2,n3,n4,n5,n6,n7,n8,n9,n10,n11,n12,n13,n14,n15,n16,n17,n18,n19,n20]]

# 收集所有模数和密文到列表中
ns = [n1,n2,n3,n4,n5,n6,n7,n8,n9,n10,n11,n12,n13,n14,n15,n16,n17,n18,n19,n20]
cs = [c1,c2,c3,c4,c5,c6,c7,c8,c9,c10,c11,c12,c13,c14,c15,c16,c17,c18,c19,c20]

print(f'ns={ns}')
print(f'cs={cs}')

"""
ns=[38322084524425631773512185026541089228405633, 25462710470915228506414306797318973893451153, 20861969451418828508261744435288112188519359, 26079638693045621562442297575422450286375073, 18524625555308070647208122101199005864281383, 18213601965187069302174137338860124574417563, 38441537682924152476395000652412779695453671, 35850397026881732249347495693156035925137511, 32008456100282843954172969257838075024865801, 35183561113608182379759381676474329763315001, 43002703308695647354814968213521236303546239, 21566139769063873727238995734498022925765689, 32872717256634153205689731031903202820774863, 41371909453059516971677387683534707012380483, 24135933667806205999865626897330770550992169, 28553655692071395449602686749806117018306751, 22106527653054086563420392821924624474791001, 33978663111547938238649441312025267324694487, 33488203801639311952450396249979406102359633, 40208713175935138594349644888388380970242613]
cs=[37943770510511201192611801861942472324524011, 18596314737066972145095279418965837937391212, 5885546191866328932841021435730643970277399, 10081724237784381950524862608911880019101134, 14086028093464003714655973382251968369005161, 9744032756492004980118816557790672232826094, 8959577962192987762494280708215101582735752, 17621534757644701692196651450718406169734886, 1785029154664370644868323383099060862867144, 10705990638388440561608885459382642839266189, 24706489839947521268568966254347581280211863, 19165088917416669803550969742060819199370086, 5765841583139606404666352105725004492025615, 30860548476792398633143427280824850511422151, 17719557389531604140525135853404819401673052, 26731364812296469313713541776971867163031586, 13250084657610878967808379732215851784837952, 7086356618266594930574622076674364373644430, 21606709501477857296910516817726269823630411, 26181004007675678964512720965689940473478115]
"""